#####################################################################
Job ID: 1401710
Job Name: MF_C100_MLP_s6
Running on host: t0043
Executing command in: /net/tscratch/people/plgspyra/BeyondBackpropagation
Using config file: configs/mf/cifar100_mlp_3x2000.yaml
Allocated GPU: 0
#####################################################################
Derived Experiment Name: cifar100_mlp_3x2000
Loading modules...
Modules loaded:
Activating virtual environment...
Checking PyTorch CUDA...
PyTorch version: 2.4.0+cu121
CUDA available: True
CUDA version: 12.1
cuDNN version: 90100
Running the experiment script...
Loading and merging configuration from: configs/mf/cifar100_mlp_3x2000.yaml
Configuration loaded and merged successfully:
{'algorithm': {'name': 'MF'},
 'algorithm_params': {'epochs_per_layer': 8,
                      'log_interval': 9999,
                      'lr': 0.00017277890583771544,
                      'mf_early_stopping_enabled': True,
                      'mf_early_stopping_min_delta': 0.0001,
                      'mf_early_stopping_patience': 4,
                      'optimizer_type': 'Adam',
                      'weight_decay': 0.0},
 'carbon_tracker': {'country_iso_code': 'POL',
                    'enabled': True,
                    'mode': 'offline',
                    'output_dir': 'results/carbon'},
 'checkpointing': {'checkpoint_dir': 'checkpoints/mf_cifar100_mlp_3x2000',
                   'save_best_metric': 'bp_val_accuracy'},
 'data': {'download': True,
          'image_size': 32,
          'input_channels': 3,
          'name': 'CIFAR100',
          'num_classes': 100,
          'root': './data',
          'val_split': 0.1},
 'data_loader': {'batch_size': 128, 'num_workers': 4, 'pin_memory': True},
 'experiment_name': 'mf_cifar100_mlp_3x2000',
 'general': {'device': 'auto', 'seed': 42},
 'logging': {'level': 'INFO',
             'wandb': {'entity': 'przspyra11',
                       'project': 'BeyondBackpropagation',
                       'use_wandb': True}},
 'model': {'name': 'MF_MLP',
           'params': {'activation': 'ReLU',
                      'bias': True,
                      'hidden_dims': [2000, 2000, 2000]}},
 'monitoring': {'enabled': True,
                'energy_enabled': True,
                'energy_interval_sec': 0.2},
 'optimizer': {'lr': 0.001, 'type': 'AdamW', 'weight_decay': 0.0001},
 'profiling': {'enabled': True, 'verbose': False},
 'training': {'criterion': 'CrossEntropyLoss',
              'early_stopping_enabled': True,
              'early_stopping_metric': 'bp_val_loss',
              'early_stopping_min_delta': 0.0,
              'early_stopping_mode': 'min',
              'early_stopping_patience': 20,
              'epochs': 100,
              'log_interval': 100},
 'tuning': {'direction': 'maximize',
            'enabled': False,
            'lr_range': [1e-05, 0.01],
            'metric': 'val_accuracy',
            'n_trials': 50,
            'pruner': 'Median',
            'sampler': 'TPE',
            'wd_range': [1e-06, 0.001]}}
2025-05-08 04:11:16,264 - root - INFO - Logging to file: results/mf_cifar100_mlp_3x2000/mf_cifar100_mlp_3x2000_run.log
2025-05-08 04:11:16,265 - root - INFO - Root logger setup complete. Level: INFO
2025-05-08 04:11:16,265 - src.utils.logging_utils - INFO - 
--- Starting Experiment ---
2025-05-08 04:11:16,265 - src.utils.logging_utils - INFO - Found EXPERIMENT_SEED environment variable: 47. Overriding config seed (42).
2025-05-08 04:11:16,344 - src.utils.helpers - INFO - Set random seed to 47 (including CUDA)
2025-05-08 04:11:16,344 - src.utils.logging_utils - INFO - Using random seed: 47
2025-05-08 04:11:16,344 - src.utils.logging_utils - INFO - Using device: cuda (Preference: 'auto')
2025-05-08 04:11:17,652 - src.utils.logging_utils - INFO - Weights & Biases run initialized: https://wandb.ai/przspyra11/BeyondBackpropagation/runs/7a0up4gi
2025-05-08 04:11:17,659 - src.utils.monitoring - INFO - NVML initialized successfully.
2025-05-08 04:11:17,660 - src.utils.monitoring - INFO - NVIDIA Driver Version: 570.86.15
2025-05-08 04:11:17,660 - src.utils.monitoring - INFO - NVML version query (nvmlSystemGetNvmlVersion) not available in this pynvml library version.
2025-05-08 04:11:17,672 - src.utils.logging_utils - INFO - NVML active for GPU 0.
2025-05-08 04:11:17,672 - src.utils.logging_utils - INFO - Initial GPU Mem: 336.62 MiB Used / 40960.00 MiB Total
2025-05-08 04:11:17,672 - src.utils.logging_utils - INFO - GPU Energy monitor initialized (Interval: 0.2s).
2025-05-08 04:11:17,672 - src.utils.codecarbon_utils - INFO - Initializing CodeCarbon OfflineEmissionsTracker. Outputting to results/carbon/mf_cifar100_mlp_3x2000_carbon.csv
2025-05-08 04:11:18,588 - src.utils.codecarbon_utils - INFO - CodeCarbon tracker started.
2025-05-08 04:11:18,588 - src.data_utils.datasets - INFO - Loading dataset: CIFAR100 from ./data
Files already downloaded and verified
Files already downloaded and verified
2025-05-08 04:11:20,060 - src.data_utils.datasets - INFO - Splitting training data randomly: 45000 train / 5000 validation samples.
2025-05-08 04:11:20,075 - src.data_utils.datasets - INFO - Applied training transforms to train subset and test transforms to validation subset.
2025-05-08 04:11:20,075 - src.data_utils.datasets - INFO - DataLoaders created: Train (351 batches, 45000 samples), Validation (20 batches, 5000 samples), Test (40 batches, 10000 samples)
2025-05-08 04:11:20,075 - src.utils.logging_utils - INFO - Dataloaders created.
2025-05-08 04:11:20,076 - src.utils.logging_utils - INFO - Getting architecture: mf_mlp (Algo: MF)
2025-05-08 04:11:20,229 - src.architectures.mf_mlp - INFO - Initialized MF_MLP with 3 hidden layers.
2025-05-08 04:11:20,231 - src.architectures.mf_mlp - INFO - Feedforward Layer dimensions (W): 3072 -> 2000 -> 2000 -> 2000 -> 100
2025-05-08 04:11:20,231 - src.architectures.mf_mlp - INFO - Created 4 projection matrices (M_0 to M_3).
2025-05-08 04:11:20,231 - src.utils.logging_utils - INFO - Model 'MF_MLP' (Algo: MF) created.
2025-05-08 04:11:20,556 - src.utils.logging_utils - INFO - Model 'MF_MLP' on cuda.
2025-05-08 04:11:20,557 - src.utils.logging_utils - INFO - Model trainable parameters: 15,257,300
2025-05-08 04:11:20,557 - src.utils.logging_utils - INFO - Model total parameters: 15,257,300
2025-05-08 04:11:21,062 - src.utils.logging_utils - INFO - Profiling FLOPs...
2025-05-08 04:11:21,186 - src.utils.profiling - INFO - Estimated Total Forward Pass FLOPs (via torch.profiler): 0.0287 GFLOPs
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO - Estimated Forward Pass GFLOPs: 0.0287 G
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO - Algorithm 'mf' is BP-free, Est. BP Update GFLOPs is N/A.
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 0) ---
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO -   initial_gpu_mem_used_mib: 336.6250
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO -   codecarbon_enabled: True
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO -   codecarbon_mode: offline
2025-05-08 04:11:21,187 - src.utils.logging_utils - INFO -   codecarbon_country_iso: POL
2025-05-08 04:11:21,188 - src.utils.logging_utils - INFO -   model_parameters_trainable: 15257300
2025-05-08 04:11:21,188 - src.utils.logging_utils - INFO -   model_parameters_total: 15257300
2025-05-08 04:11:21,188 - src.utils.logging_utils - INFO -   estimated_fwd_gflops: 0.0287
2025-05-08 04:11:21,188 - src.utils.logging_utils - INFO -   estimated_bp_update_gflops: nan
2025-05-08 04:11:21,188 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:21,188 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:21,188 - src.utils.logging_utils - INFO - Starting training phase...
2025-05-08 04:11:21,189 - src.utils.monitoring - INFO - Started energy monitoring for GPU 0 (interval: 0.2s).
2025-05-08 04:11:21,189 - src.algorithms.mf - INFO - Starting layer-wise MF training for MLP with 3 W-layers and 4 M-matrices.
2025-05-08 04:11:21,431 - src.algorithms.mf - INFO - --- Starting MF training for Layer_W1_M1 ---
2025-05-08 04:11:25,924 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:25,924 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 351) ---
2025-05-08 04:11:25,924 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.7692
2025-05-08 04:11:25,924 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1070.0000
2025-05-08 04:11:25,924 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:25,924 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:25,925 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 1/8 - Train Loss: 3.904634, Peak Mem: 1070.0 MiB
2025-05-08 04:11:25,925 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:25,925 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 351) ---
2025-05-08 04:11:25,926 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.9046
2025-05-08 04:11:25,926 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1070.0000
2025-05-08 04:11:25,926 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:25,926 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:26,203 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 1/8 - Val Local Loss: 3.658761
2025-05-08 04:11:26,204 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:26,204 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 351) ---
2025-05-08 04:11:26,204 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.6588
2025-05-08 04:11:26,204 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:26,205 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:30,597 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:30,598 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 702) ---
2025-05-08 04:11:30,598 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.4756
2025-05-08 04:11:30,598 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1074.0000
2025-05-08 04:11:30,598 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:30,598 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:30,599 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 2/8 - Train Loss: 3.640425, Peak Mem: 1074.0 MiB
2025-05-08 04:11:30,599 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:30,599 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 702) ---
2025-05-08 04:11:30,600 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.6404
2025-05-08 04:11:30,600 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1074.0000
2025-05-08 04:11:30,600 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:30,600 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:30,835 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 2/8 - Val Local Loss: 3.513785
2025-05-08 04:11:30,836 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:30,836 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 702) ---
2025-05-08 04:11:30,836 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.5138
2025-05-08 04:11:30,836 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:30,836 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:35,242 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:35,242 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1053) ---
2025-05-08 04:11:35,243 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.3772
2025-05-08 04:11:35,243 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1074.0000
2025-05-08 04:11:35,243 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:35,243 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:35,244 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 3/8 - Train Loss: 3.521845, Peak Mem: 1074.0 MiB
2025-05-08 04:11:35,244 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:35,244 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1053) ---
2025-05-08 04:11:35,244 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.5218
2025-05-08 04:11:35,244 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1074.0000
2025-05-08 04:11:35,244 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:35,244 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:35,477 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 3/8 - Val Local Loss: 3.456273
2025-05-08 04:11:35,478 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:35,478 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1053) ---
2025-05-08 04:11:35,478 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.4563
2025-05-08 04:11:35,478 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:35,478 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:39,878 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:39,879 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1404) ---
2025-05-08 04:11:39,879 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.5887
2025-05-08 04:11:39,879 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1074.0000
2025-05-08 04:11:39,879 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:39,879 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:39,880 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 4/8 - Train Loss: 3.443658, Peak Mem: 1074.0 MiB
2025-05-08 04:11:39,880 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:39,880 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1404) ---
2025-05-08 04:11:39,880 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.4437
2025-05-08 04:11:39,880 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1074.0000
2025-05-08 04:11:39,880 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:39,880 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:40,114 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 4/8 - Val Local Loss: 3.378662
2025-05-08 04:11:40,115 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:40,115 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1404) ---
2025-05-08 04:11:40,115 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.3787
2025-05-08 04:11:40,115 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:40,115 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:44,516 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:44,517 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1755) ---
2025-05-08 04:11:44,517 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.4756
2025-05-08 04:11:44,517 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1074.0000
2025-05-08 04:11:44,517 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:44,517 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:44,518 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 5/8 - Train Loss: 3.381603, Peak Mem: 1074.0 MiB
2025-05-08 04:11:44,518 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:44,518 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1755) ---
2025-05-08 04:11:44,518 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.3816
2025-05-08 04:11:44,518 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1074.0000
2025-05-08 04:11:44,518 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:44,518 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:44,751 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 5/8 - Val Local Loss: 3.321837
2025-05-08 04:11:44,752 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:44,752 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 1755) ---
2025-05-08 04:11:44,752 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.3218
2025-05-08 04:11:44,752 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:44,752 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:49,155 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:49,156 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2106) ---
2025-05-08 04:11:49,156 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.4121
2025-05-08 04:11:49,156 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1074.0000
2025-05-08 04:11:49,156 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:49,156 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:49,157 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 6/8 - Train Loss: 3.327369, Peak Mem: 1074.0 MiB
2025-05-08 04:11:49,157 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:49,157 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2106) ---
2025-05-08 04:11:49,157 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.3274
2025-05-08 04:11:49,157 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1074.0000
2025-05-08 04:11:49,157 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:49,157 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:49,389 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 6/8 - Val Local Loss: 3.301356
2025-05-08 04:11:49,390 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:49,390 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2106) ---
2025-05-08 04:11:49,390 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.3014
2025-05-08 04:11:49,390 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:49,390 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:53,786 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:53,787 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2457) ---
2025-05-08 04:11:53,787 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.4472
2025-05-08 04:11:53,787 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1074.0000
2025-05-08 04:11:53,787 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:53,787 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:53,788 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 7/8 - Train Loss: 3.283548, Peak Mem: 1074.0 MiB
2025-05-08 04:11:53,788 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:53,788 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2457) ---
2025-05-08 04:11:53,788 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.2835
2025-05-08 04:11:53,788 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1074.0000
2025-05-08 04:11:53,788 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:53,788 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:54,021 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 7/8 - Val Local Loss: 3.238188
2025-05-08 04:11:54,022 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:54,022 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2457) ---
2025-05-08 04:11:54,022 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.2382
2025-05-08 04:11:54,022 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:54,022 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,434 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,435 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2808) ---
2025-05-08 04:11:58,435 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_Batch: 3.3182
2025-05-08 04:11:58,436 - src.utils.logging_utils - INFO -   Layer_W1_M1/GPU_Mem_Used_MiB_Batch: 1074.0000
2025-05-08 04:11:58,436 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:58,436 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,436 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 8/8 - Train Loss: 3.242511, Peak Mem: 1074.0 MiB
2025-05-08 04:11:58,437 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,437 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2808) ---
2025-05-08 04:11:58,437 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_EpochAvg: 3.2425
2025-05-08 04:11:58,437 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Epoch_MiB: 1074.0000
2025-05-08 04:11:58,437 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:58,437 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,671 - src.algorithms.mf - INFO - Layer_W1_M1 Epoch 8/8 - Val Local Loss: 3.271374
2025-05-08 04:11:58,671 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,671 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2808) ---
2025-05-08 04:11:58,671 - src.utils.logging_utils - INFO -   Layer_W1_M1/Val_LocalLoss_Epoch: 3.2714
2025-05-08 04:11:58,671 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 2808) ---
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO -   Layer_W1_M1/Train_Loss_LayerAvg: 3.2425
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO -   Layer_W1_M1/Peak_GPU_Mem_Layer_MiB: 1074.0000
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO -   Layer_W1_M1/Epochs_Trained: 8
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:11:58,672 - src.utils.logging_utils - INFO - 
2025-05-08 04:11:58,749 - src.algorithms.mf - INFO - --- Starting MF training for Layer_W2_M2 ---
2025-05-08 04:12:03,135 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:03,136 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3159) ---
2025-05-08 04:12:03,136 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 3.4821
2025-05-08 04:12:03,136 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:03,136 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:03,136 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:03,137 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 1/8 - Train Loss: 3.684922, Peak Mem: 1126.0 MiB
2025-05-08 04:12:03,137 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:03,137 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3159) ---
2025-05-08 04:12:03,137 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 3.6849
2025-05-08 04:12:03,137 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:03,137 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:03,137 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:03,370 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 1/8 - Val Local Loss: 3.384054
2025-05-08 04:12:03,370 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:03,370 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3159) ---
2025-05-08 04:12:03,370 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.3841
2025-05-08 04:12:03,370 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:03,371 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:07,765 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:07,766 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3510) ---
2025-05-08 04:12:07,766 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 3.1212
2025-05-08 04:12:07,766 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:07,766 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:07,766 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:07,767 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 2/8 - Train Loss: 3.318054, Peak Mem: 1126.0 MiB
2025-05-08 04:12:07,767 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:07,767 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3510) ---
2025-05-08 04:12:07,767 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 3.3181
2025-05-08 04:12:07,767 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:07,767 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:07,767 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:08,000 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 2/8 - Val Local Loss: 3.247634
2025-05-08 04:12:08,000 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:08,000 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3510) ---
2025-05-08 04:12:08,000 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.2476
2025-05-08 04:12:08,000 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:08,000 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:12,390 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:12,391 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3861) ---
2025-05-08 04:12:12,391 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 3.1820
2025-05-08 04:12:12,391 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:12,391 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:12,391 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:12,392 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 3/8 - Train Loss: 3.187769, Peak Mem: 1126.0 MiB
2025-05-08 04:12:12,392 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:12,392 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3861) ---
2025-05-08 04:12:12,392 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 3.1878
2025-05-08 04:12:12,392 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:12,392 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:12,392 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:12,627 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 3/8 - Val Local Loss: 3.166553
2025-05-08 04:12:12,627 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:12,627 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 3861) ---
2025-05-08 04:12:12,627 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.1666
2025-05-08 04:12:12,627 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:12,627 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:17,021 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:17,021 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4212) ---
2025-05-08 04:12:17,022 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 3.1568
2025-05-08 04:12:17,022 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:17,022 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:17,022 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:17,023 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 4/8 - Train Loss: 3.100638, Peak Mem: 1126.0 MiB
2025-05-08 04:12:17,023 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:17,023 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4212) ---
2025-05-08 04:12:17,023 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 3.1006
2025-05-08 04:12:17,023 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:17,023 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:17,023 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:17,256 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 4/8 - Val Local Loss: 3.109414
2025-05-08 04:12:17,256 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:17,256 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4212) ---
2025-05-08 04:12:17,256 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.1094
2025-05-08 04:12:17,256 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:17,256 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:21,646 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:21,647 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4563) ---
2025-05-08 04:12:21,647 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 2.8779
2025-05-08 04:12:21,647 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:21,647 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:21,647 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:21,648 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 5/8 - Train Loss: 3.027839, Peak Mem: 1126.0 MiB
2025-05-08 04:12:21,648 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:21,648 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4563) ---
2025-05-08 04:12:21,648 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 3.0278
2025-05-08 04:12:21,648 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:21,648 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:21,648 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:21,881 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 5/8 - Val Local Loss: 3.083171
2025-05-08 04:12:21,881 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:21,881 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4563) ---
2025-05-08 04:12:21,882 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.0832
2025-05-08 04:12:21,882 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:21,882 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:26,283 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:26,283 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4914) ---
2025-05-08 04:12:26,284 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 2.6211
2025-05-08 04:12:26,284 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:26,284 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:26,284 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:26,285 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 6/8 - Train Loss: 2.979779, Peak Mem: 1126.0 MiB
2025-05-08 04:12:26,285 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:26,285 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4914) ---
2025-05-08 04:12:26,285 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 2.9798
2025-05-08 04:12:26,285 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:26,285 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:26,285 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:26,518 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 6/8 - Val Local Loss: 3.041788
2025-05-08 04:12:26,519 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:26,519 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 4914) ---
2025-05-08 04:12:26,519 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.0418
2025-05-08 04:12:26,519 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:26,519 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:30,920 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:30,920 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5265) ---
2025-05-08 04:12:30,920 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 2.7170
2025-05-08 04:12:30,920 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:30,921 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:30,921 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:30,921 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 7/8 - Train Loss: 2.921688, Peak Mem: 1126.0 MiB
2025-05-08 04:12:30,922 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:30,922 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5265) ---
2025-05-08 04:12:30,922 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 2.9217
2025-05-08 04:12:30,922 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:30,922 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:30,922 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:31,158 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 7/8 - Val Local Loss: 3.035042
2025-05-08 04:12:31,158 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:31,158 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5265) ---
2025-05-08 04:12:31,158 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.0350
2025-05-08 04:12:31,158 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:31,158 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,534 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,535 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5616) ---
2025-05-08 04:12:35,535 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_Batch: 2.6306
2025-05-08 04:12:35,535 - src.utils.logging_utils - INFO -   Layer_W2_M2/GPU_Mem_Used_MiB_Batch: 1126.0000
2025-05-08 04:12:35,535 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:35,535 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,536 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 8/8 - Train Loss: 2.877574, Peak Mem: 1126.0 MiB
2025-05-08 04:12:35,536 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,536 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5616) ---
2025-05-08 04:12:35,536 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_EpochAvg: 2.8776
2025-05-08 04:12:35,536 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Epoch_MiB: 1126.0000
2025-05-08 04:12:35,536 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:35,536 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,770 - src.algorithms.mf - INFO - Layer_W2_M2 Epoch 8/8 - Val Local Loss: 3.023554
2025-05-08 04:12:35,771 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,771 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5616) ---
2025-05-08 04:12:35,771 - src.utils.logging_utils - INFO -   Layer_W2_M2/Val_LocalLoss_Epoch: 3.0236
2025-05-08 04:12:35,771 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:35,771 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,771 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,772 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5616) ---
2025-05-08 04:12:35,772 - src.utils.logging_utils - INFO -   Layer_W2_M2/Train_Loss_LayerAvg: 2.8776
2025-05-08 04:12:35,772 - src.utils.logging_utils - INFO -   Layer_W2_M2/Peak_GPU_Mem_Layer_MiB: 1126.0000
2025-05-08 04:12:35,772 - src.utils.logging_utils - INFO -   Layer_W2_M2/Epochs_Trained: 8
2025-05-08 04:12:35,772 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:35,772 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:35,849 - src.algorithms.mf - INFO - --- Starting MF training for Layer_W3_M3 ---
2025-05-08 04:12:40,228 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:40,229 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5967) ---
2025-05-08 04:12:40,229 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 3.2628
2025-05-08 04:12:40,230 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:12:40,230 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:40,230 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:40,231 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 1/8 - Train Loss: 3.426833, Peak Mem: 1142.0 MiB
2025-05-08 04:12:40,231 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:40,231 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5967) ---
2025-05-08 04:12:40,231 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 3.4268
2025-05-08 04:12:40,231 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:12:40,231 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:40,231 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:40,465 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 1/8 - Val Local Loss: 3.155528
2025-05-08 04:12:40,466 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:40,466 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 5967) ---
2025-05-08 04:12:40,466 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 3.1555
2025-05-08 04:12:40,466 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:40,466 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:44,842 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:44,844 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 6318) ---
2025-05-08 04:12:44,844 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 2.8736
2025-05-08 04:12:44,844 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:12:44,844 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:44,844 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:44,845 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 2/8 - Train Loss: 3.044072, Peak Mem: 1142.0 MiB
2025-05-08 04:12:44,845 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:44,845 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 6318) ---
2025-05-08 04:12:44,845 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 3.0441
2025-05-08 04:12:44,845 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:12:44,845 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:44,845 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:45,079 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 2/8 - Val Local Loss: 3.069452
2025-05-08 04:12:45,079 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:45,079 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 6318) ---
2025-05-08 04:12:45,079 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 3.0695
2025-05-08 04:12:45,079 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:45,079 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:49,449 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:49,451 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 6669) ---
2025-05-08 04:12:49,451 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 2.9373
2025-05-08 04:12:49,451 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:12:49,451 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:49,451 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:49,452 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 3/8 - Train Loss: 2.916956, Peak Mem: 1142.0 MiB
2025-05-08 04:12:49,452 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:49,452 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 6669) ---
2025-05-08 04:12:49,452 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 2.9170
2025-05-08 04:12:49,452 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:12:49,452 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:49,452 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:49,688 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 3/8 - Val Local Loss: 3.022451
2025-05-08 04:12:49,689 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:49,689 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 6669) ---
2025-05-08 04:12:49,689 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 3.0225
2025-05-08 04:12:49,689 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:49,689 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:54,098 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:54,099 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7020) ---
2025-05-08 04:12:54,099 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 3.2217
2025-05-08 04:12:54,099 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:12:54,099 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:54,099 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:54,100 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 4/8 - Train Loss: 2.826997, Peak Mem: 1142.0 MiB
2025-05-08 04:12:54,100 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:54,100 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7020) ---
2025-05-08 04:12:54,101 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 2.8270
2025-05-08 04:12:54,101 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:12:54,101 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:54,101 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:54,335 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 4/8 - Val Local Loss: 3.014448
2025-05-08 04:12:54,337 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:54,337 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7020) ---
2025-05-08 04:12:54,337 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 3.0144
2025-05-08 04:12:54,337 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:54,337 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:58,729 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:58,729 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7371) ---
2025-05-08 04:12:58,729 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 3.0418
2025-05-08 04:12:58,729 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:12:58,729 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:58,730 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:58,730 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 5/8 - Train Loss: 2.762877, Peak Mem: 1142.0 MiB
2025-05-08 04:12:58,730 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:58,730 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7371) ---
2025-05-08 04:12:58,731 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 2.7629
2025-05-08 04:12:58,731 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:12:58,731 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:58,731 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:58,965 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 5/8 - Val Local Loss: 2.978270
2025-05-08 04:12:58,967 - src.utils.logging_utils - INFO - 
2025-05-08 04:12:58,967 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7371) ---
2025-05-08 04:12:58,967 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 2.9783
2025-05-08 04:12:58,967 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:12:58,967 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:03,353 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:03,354 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7722) ---
2025-05-08 04:13:03,354 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 2.6172
2025-05-08 04:13:03,354 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:13:03,354 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:03,354 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:03,355 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 6/8 - Train Loss: 2.704418, Peak Mem: 1142.0 MiB
2025-05-08 04:13:03,355 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:03,355 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7722) ---
2025-05-08 04:13:03,355 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 2.7044
2025-05-08 04:13:03,355 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:13:03,355 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:03,355 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:03,590 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 6/8 - Val Local Loss: 2.966470
2025-05-08 04:13:03,592 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:03,592 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 7722) ---
2025-05-08 04:13:03,592 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 2.9665
2025-05-08 04:13:03,592 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:03,592 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:07,994 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:07,995 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 8073) ---
2025-05-08 04:13:07,995 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 2.9598
2025-05-08 04:13:07,995 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:13:07,995 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:07,995 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:07,996 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 7/8 - Train Loss: 2.655446, Peak Mem: 1142.0 MiB
2025-05-08 04:13:07,996 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:07,996 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 8073) ---
2025-05-08 04:13:07,996 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 2.6554
2025-05-08 04:13:07,996 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:13:07,996 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:07,996 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:08,230 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 7/8 - Val Local Loss: 2.963323
2025-05-08 04:13:08,231 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:08,231 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 8073) ---
2025-05-08 04:13:08,231 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 2.9633
2025-05-08 04:13:08,231 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:08,231 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,615 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,615 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 8424) ---
2025-05-08 04:13:12,615 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_Batch: 2.4323
2025-05-08 04:13:12,615 - src.utils.logging_utils - INFO -   Layer_W3_M3/GPU_Mem_Used_MiB_Batch: 1142.0000
2025-05-08 04:13:12,615 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:12,615 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,616 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 8/8 - Train Loss: 2.603079, Peak Mem: 1142.0 MiB
2025-05-08 04:13:12,616 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,616 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 8424) ---
2025-05-08 04:13:12,616 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_EpochAvg: 2.6031
2025-05-08 04:13:12,616 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Epoch_MiB: 1142.0000
2025-05-08 04:13:12,617 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:12,617 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,850 - src.algorithms.mf - INFO - Layer_W3_M3 Epoch 8/8 - Val Local Loss: 2.946301
2025-05-08 04:13:12,851 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,851 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 8424) ---
2025-05-08 04:13:12,851 - src.utils.logging_utils - INFO -   Layer_W3_M3/Val_LocalLoss_Epoch: 2.9463
2025-05-08 04:13:12,851 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:12,851 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,851 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,852 - src.utils.logging_utils - INFO - --- Metrics Log (Step: 8424) ---
2025-05-08 04:13:12,852 - src.utils.logging_utils - INFO -   Layer_W3_M3/Train_Loss_LayerAvg: 2.6031
2025-05-08 04:13:12,852 - src.utils.logging_utils - INFO -   Layer_W3_M3/Peak_GPU_Mem_Layer_MiB: 1142.0000
2025-05-08 04:13:12,852 - src.utils.logging_utils - INFO -   Layer_W3_M3/Epochs_Trained: 8
2025-05-08 04:13:12,852 - src.utils.logging_utils - INFO - --- End Metrics Log ---
2025-05-08 04:13:12,852 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:12,925 - src.algorithms.mf - INFO - Finished all layer-wise MF training. Total Epochs Trained (Sum): 24
2025-05-08 04:13:12,925 - src.utils.logging_utils - INFO - Received Peak GPU Memory (sampled during training): 1142.00 MiB
2025-05-08 04:13:12,926 - src.utils.monitoring - INFO - Stopped energy monitoring for GPU 0.
2025-05-08 04:13:12,926 - src.utils.logging_utils - INFO - Starting evaluation phase on test set...
2025-05-08 04:13:12,927 - src.algorithms.mf - INFO - Evaluating MF (MF_MLP) using a_3 and M_3.
2025-05-08 04:13:13,424 - src.algorithms.mf - INFO - MF Evaluation Results (MF_MLP, BP-style): Accuracy: 30.48%
2025-05-08 04:13:13,424 - src.utils.logging_utils - INFO - Test Set Results: Acc: 30.48%, Loss: nan
2025-05-08 04:13:13,424 - src.utils.logging_utils - INFO - Stopping CodeCarbon tracker...
2025-05-08 04:13:13,942 - src.utils.logging_utils - INFO - CodeCarbon tracker stopped. Attempting to read from: results/carbon/mf_cifar100_mlp_3x2000_carbon.csv
2025-05-08 04:13:14,445 - src.utils.logging_utils - INFO - Read emissions: 0.003700 kgCO2e (3.700 gCO2e) (attempt 1)
2025-05-08 04:13:14,445 - src.utils.monitoring - INFO - Energy monitor for GPU 0 is not running.
2025-05-08 04:13:14,445 - src.utils.logging_utils - INFO - Total GPU Energy (NVML Monitor): 7379.93 J (2.0500 Wh)
2025-05-08 04:13:14,445 - src.utils.logging_utils - INFO - GPU Mem (End): 1142.00 MiB Used / 40960.00 MiB Total
2025-05-08 04:13:14,445 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:14,445 - src.utils.logging_utils - INFO - --- Final Summary Metrics (Step: 8425) ---
2025-05-08 04:13:14,445 - src.utils.logging_utils - INFO -   final/total_run_duration_sec: 117.1589
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/peak_gpu_mem_used_mib: 1142.0000
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/total_gpu_energy_joules: 7379.926458
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/total_gpu_energy_wh: 2.049980
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/training_duration_sec: 111.7377
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/Test_Accuracy: 30.4800
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/Test_Loss: nan
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/estimated_fwd_gflops: 0.0287
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/estimated_bp_update_gflops: nan
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO -   final/codecarbon_emissions_gCO2e: 3.700038
2025-05-08 04:13:14,446 - src.utils.logging_utils - INFO - --- End Final Summary ---
2025-05-08 04:13:14,447 - src.utils.logging_utils - INFO - 
2025-05-08 04:13:14,447 - src.utils.logging_utils - INFO - Total run duration: 00:01:57
2025-05-08 04:13:14,447 - src.utils.logging_utils - INFO - --> Final Calculated Emissions: 3.700 gCO2e
2025-05-08 04:13:15,545 - src.utils.logging_utils - INFO - W&B run finished.
2025-05-08 04:13:15,545 - src.utils.monitoring - INFO - NVML shut down successfully.
2025-05-08 04:13:15,599 - src.utils.logging_utils - INFO - 
--- Experiment Finished ---
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO - Results:
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO - {'codecarbon_country_iso': 'POL',
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'codecarbon_csv_path': 'results/carbon/mf_cifar100_mlp_3x2000_carbon.csv',
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'codecarbon_emissions_gCO2e': 3.7000383723704,
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'codecarbon_enabled': True,
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'codecarbon_mode': 'offline',
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'estimated_bp_update_gflops': nan,
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'estimated_fwd_gflops': 0.028688,
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'peak_gpu_mem_used_mib': 1142.0,
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'test_accuracy': 30.48,
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'test_loss': nan,
2025-05-08 04:13:15,600 - src.utils.logging_utils - INFO -  'total_gpu_energy_joules': 7379.9264575355655,
2025-05-08 04:13:15,601 - src.utils.logging_utils - INFO -  'total_gpu_energy_wh': 2.049979571537657,
2025-05-08 04:13:15,601 - src.utils.logging_utils - INFO -  'total_run_duration_sec': 117.15894937515259,
2025-05-08 04:13:15,601 - src.utils.logging_utils - INFO -  'training_duration_sec': 111.73765254020691}
2025-05-08 04:13:15,601 - src.utils.logging_utils - INFO - 
--- Experiment Finished Successfully ---
Deactivating virtual environment...
#####################################################################
Job finished with exit code 0 at Thu May  8 04:13:17 CEST 2025
#####################################################################
